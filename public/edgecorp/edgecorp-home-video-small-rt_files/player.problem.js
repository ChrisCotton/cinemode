h.Problem=MingClass.extend({init:function(a,b,e){var d=document;d.getElementById("problem_msgwrapper_"+e.uniqueId);d=d.getElementById("problem_message_"+e.uniqueId);this.element=a;this.clipId=e.clipId;this.uniqueId=e.uniqueId;this.cookieRefresh=e.cookieRefresh;this.domain=e.domain;new b(d,this)}});h.Problem.playIcon={draw:[{beginPath:null},{moveTo:[0,0]},{lineTo:[20,10]},{lineTo:[0,20]},{fill:null}],translate:{x:0,y:0},
scale:1};h.Problem.lockIcon={draw:[{lineCap:"butt"},{lineJoin:"round"},{mitterLimit:"1"},{beginPath:null},{moveTo:[173,139]},{bezierCurveTo:[173,108,173,100,173,95]},{bezierCurveTo:[173,62,166,38,150,23]},{bezierCurveTo:[135,8,116,0,95,0]},{bezierCurveTo:[75,0,56,8,40,23]},{bezierCurveTo:[25,38,18,56,18,77]},{lineTo:[18,139]},{bezierCurveTo:[6,139,0,144,0,152]},{lineTo:[0,285]},{bezierCurveTo:[0,288,1,291,4,294]},{bezierCurveTo:[6,296,9,298,13,298]},{lineTo:[179,298]},{bezierCurveTo:[182,298,185,
296,188,294]},{bezierCurveTo:[190,291,192,288,192,285]},{lineTo:[192,152]},{bezierCurveTo:[192,144,185,139,173,139]},{closePath:null},{moveTo:[129,43]},{bezierCurveTo:[138,53,143,64,143,77]},{lineTo:[143,139]},{lineTo:[48,139]},{lineTo:[48,77]},{bezierCurveTo:[48,64,52,53,62,43]},{bezierCurveTo:[71,34,82,30,95,30]},{bezierCurveTo:[105,30,119,34,129,43]},{closePath:null},{fill:null},0],translate:{x:0,y:1},scale:0.37};h.Problem.unlockIcon={draw:[{beginPath:null},{moveTo:[174,95]},{bezierCurveTo:[173,
93,174,91,173,90]},{bezierCurveTo:[173,60,165,38,150,23]},{bezierCurveTo:[135,8,116,0,95,0]},{bezierCurveTo:[74,0,56,8,40,23]},{bezierCurveTo:[25,38,18,56,18,77]},{lineTo:[18,139]},{bezierCurveTo:[6,139,0,144,0,152]},{lineTo:[0,285]},{bezierCurveTo:[0,288,1,291,4,294]},{bezierCurveTo:[6,296,9,298,13,298]},{lineTo:[179,298]},{bezierCurveTo:[182,298,185,296,188,294]},{bezierCurveTo:[190,291,192,288,192,285]},{lineTo:[192,152]},{bezierCurveTo:[192,144,185,139,173,139]},{lineTo:[48,139]},{lineTo:[48,
77]},{bezierCurveTo:[48,64,52,53,62,43]},{bezierCurveTo:[71,34,82,30,95,30]},{bezierCurveTo:[95,30,119,34,129,43]},{bezierCurveTo:[138,53,143,64,143,77]},{lineTo:[143,97]},{lineTo:[174,97]},{bezierCurveTo:[174,96,174,95,174,95]},{closePath:null},{fill:null}],translate:{x:0,y:1},scale:0.37};h.Problem.ProblemPage=MingClass.extend({init:function(a,b){var e=this;e.element=a;e.controller=b;e.updateLayout();e.slideIn();e.onResize=function(){e.updateLayout()};$m.addEventListener(window,"resize",e.onResize)},
destroy:function(){$m.removeEventListener(window,"resize",this.onResize)},updateLayout:function(){function a(){f.style.bottom=h&&!$m.hasClass(h,y)?h.clientHeight/2-10+"px":"";if(h&&h.clientHeight>0&&h.clientHeight>(f.clientHeight-$m.innerHeight(d))/2)if($m.hasClass(j,y)){if(h.hasClass(y))return false;$m.addClass(h,y)}else $m.addClass(j,y);else if($m.innerHeight(d)>=t)if($m.hasClass(j,y))if(g&&!$m.hasClass(g,y))$m.addClass(g,y);else{if($m.hasClass(d,N))return false;$m.addClass(d,N)}else $m.addClass(j,
y);else return false;a()}var b=this,e=document,d=b.element,c=b.controller.uniqueId,g=e.getElementById("h_"+c),j=e.getElementById("p_"+c),f=d.parentNode,h=e.getElementById("logo_"+c),t=e.body.clientHeight;h&&$m.removeClass(h,y);$m.removeClass(j,y);$m.removeClass(g,y);f.style.bottom="";$m.removeClass(d,N);a();(function(){var a=2180/552,c=b.controller.element,e=d.clientWidth/d.clientHeight;if(e>a){$m.removeClass(c,Fa);$m.addClass(c,Ea)}else if(e<a){$m.removeClass(c,Ea);$m.addClass(c,Fa)}else{$m.removeClass(c,
Ea);$m.removeClass(c,Fa)}})()},slideIn:function(){var a=this.element;$m.removeClass(a,Za);$m.addClass(a,Ya)},slideOut:function(){var a=this.element;$m.removeClass(a,Ya);$m.addClass(a,Za)}});h.Problem.PrivateLocked=h.Problem.ProblemPage.extend({init:function(a,b){var e=document.getElementById("lock_"+b.uniqueId),d=h.Problem.lockIcon,e=new h.UI.CanvasElement(e);e.draw(d.draw,d.translate,d.scale);this.lock=e;this._super(a,b)},updateLayout:function(){this._super();var a=document,b=a.body,a=a.getElementById("lock_"+
this.controller.uniqueId),e=b.clientWidth*0.8,b=b.clientHeight*0.8,d=a.clientWidth,c=a.clientHeight;a.style.webkitTransform="";if(d>e||c>b){scale=e>b?b/c:e/d;if(!(scale>=1))a.style.webkitTransform="scale("+scale+")"}}});h.Problem.PrivateUnlocked=h.Problem.PrivateLocked.extend({init:function(a,b){function e(a){d.slideOut();c.location.href=c.location.href+(c.location.href.indexOf("?")>0?"&":"?")+"unlocked_play=1";if(a.returnValue)a.returnValue=false;else if(a.preventDefault)a.preventDefault();else return false}
var d=this,c=document,g=h.Problem.unlockIcon,j=c.getElementById("play_"+b.uniqueId),f=h.Problem.playIcon;(new h.UI.CanvasElement(j)).draw(f.draw,f.translate,f.scale);d._super(a,b);d.lock.draw(g.draw,g.translate,g.scale);j.addEventListener?j.addEventListener("click",e,false):c.getElementById("play_ie_"+b.uniqueId).attachEvent("onclick",e)}});h.Problem.PrivatePassword=h.Problem.ProblemPage.extend({init:function(a,b){this._super(a,b);var e=this,d=b.uniqueId,c=document,g=c.getElementById("clip_pwd_"+
d);g.getElementsByTagName("fieldset");var j=c.getElementById("pwd_"+d),f=c.getElementById("error_"+d),n=new XHR,t;$m.addEventListener(g,"submit",function(a){t=setTimeout(function(){$m.addClass(g,Ba)},250);n.postWithCredentials("/check_password","clip_id="+b.clipId+"&password="+j.value,function(a){function c(){$m.removeClass(g,pc);$m.removeEventListener(j,"focus",c);$m.removeEventListener(j,"keydown",c);j.focus()}!a.success&&!a.message&&(a=eval("("+a+")"));if(a.success){h.setCookie(a.cookie_name,a.cookie,
1,b.domain);j.blur();if(!b.cookieRefresh){e.slideOut();h.xhrRefresh()}e.destroy()}else if(a.message){clearInterval(t);$m.removeClass(g,Ba);$m.addClass(g,pc);f.innerText=a.message;$m.addEventListener(f,"click",c);$m.addEventListener(j,"focus",c);$m.addEventListener(j,"keydown",c);j.value=""}});if(a.returnValue)a.returnValue=false;else if(a.preventDefault)a.preventDefault();else return false})},updateLayout:function(){function a(){if($m.hasClass(d,N))c.clientWidth+g.clientWidth>e.width-10&&$m.addClass(g,
y);else if(d.clientWidth<gc){$m.addClass(d,N);a()}}var b=this.controller.uniqueId,e=document,d=this.element;e.getElementById("clip_pwd_"+b);var c=e.getElementById("pwd_"+b),g=e.getElementById("submit_pwdbtn_"+b);$m.removeClass(g,y);this._super();a()}});